{% extends "base.html" %}
{% load static %}

{% block content %}
  {% if form.errors %}
    <div class="form-errors" style="color: red; margin-bottom: 1rem;">
      <strong>Ocorreram erros no formulário:</strong>
      {{ form.errors }}
    </div>
  {% endif %}
    
    
      <!-- Seção do Formulário -->
      <form action="{% url 'produtos:cadastrar' %}" method="POST" id="productForm">
        {% csrf_token %}
      <div class="form-section">
        <h2>Adicionar/Editar Produto</h2>
        <div class="form-group">
        {{form.nome.label_tag}} {{form.nome}}
        </div>
        <div class="form-group">
        {{form.categoria.label_tag}} {{form.categoria}}
        
        </div>
        
        <div class="form-group">
        {{form.quantidade.label_tag}} {{form.quantidade}}
        </div>

        <div class="form-group">
        {{form.preco.label_tag}} {{form.preco}}
        </div>

        <div class="form-group">
        {{form.validade.label_tag}} {{form.validade}}
        </div>

        <div class="form-group">
        {{form.lote.label_tag}} {{form.lote}}
        </div>

        <div class="form-buttons">
            <button type="submit" id="submitBtn" class="btn-edit">Adicionar Produto</button>

            <button type="button" id="clearFormBtn" class="btn-edit" style="background:#6c757d; margin-left:8px;">Limpar Formulário</button>

            <button type="button" id="cancelBtn" style="display: none">Cancelar</button>
          </div>

        </form>

        <script>
          // Botão para limpar o formulário de produto
          (function(){
            document.addEventListener('DOMContentLoaded', function(){
              const form = document.getElementById('productForm');
              const clearBtn = document.getElementById('clearFormBtn');
              if (!form || !clearBtn) return;

              clearBtn.addEventListener('click', function(){
                form.reset();

                form.querySelectorAll('select').forEach(s => s.selectedIndex = 0);

                form.querySelectorAll('input[type=text], input[type=number], input[type=date], textarea').forEach(i => i.value = '');

                const nameInput = form.querySelector('input[name="nome"]');
                if (nameInput) {
                  try {
                    nameInput.focus();
                    if (typeof nameInput.select === 'function') nameInput.select();
                  } catch (e) {}
                }
              });
            });
          })();
        </script>


    </div>
    {% endblock %}
